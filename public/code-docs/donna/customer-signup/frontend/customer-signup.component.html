<body class="gray-bg">
    <div class="wrapper wrapper-content animated">
        <div class="row" style="margin-top: 50px;">
            <div class="col-lg-12">
                <div class="ibox">
                    <div class="ibox-title">
                        <h5>Registration</h5>
                        <div class="ibox-tools">
                            <a class="collapse-link">
                                <i class="fa fa-chevron-up"></i>
                            </a>
                        </div>
                    </div>
                    <div class="ibox-content">
                        <h2>Customer Registration Form</h2>
                        <p>
                            Please fill in all required fields to submit application. The city of {{globals.onlyCityName}} will review this application and be able to
                            to give access to the use of the site.
                        </p>

                        <div *ngIf="errorMessage" style="color: red;" class="text-center">
                            <p>{{errorMessage}}</p>
                        </div>

                        <form [formGroup]="signupCustomerFormGroup" (ngSubmit)="signup()"  id="form" class="wizard-big" role="form">
                            <tabset  #staticTabs >
                                <tab heading="1.Account" [active]="true" #1 >
                                    <h2 >Account Information</h2>
                                    <form [formGroup]="accountFormGroup">
                                    <div class="row">
                                        <div class="col-lg-8">
                                        <form [formGroup]="emailFormGroup">
                                            <div class="form-group">
                                                <label>Email * <span class="text-warning" *ngIf="email.touched == true && email.dirty == true && emailFormGroup.valid == false">Valid e-mail example: <br> anyemail@anydomain.com </span></label>
                                                <input required name="email"  type="email" class="form-control required" formControlName="email">
                                                <p class="bg-danger p-xs b-r-sm" *ngIf="email.touched == true && email.dirty == true && emailFormGroup.valid == false">Please enter a valid e-mail</p>
                                            </div>
                                        </form>
                                        <form [formGroup]="passwordFormGroup">
                                            <div class="form-group">
                                                <label>Password *</label>
                                                <input  required name="password"   type="password" class="form-control required" formControlName="password"
                                                popover="At least 1 uppercase,
                                                * At least 1 Lowercase,
                                                * 10 Characters min,
                                                * 1 Special character,
                                                * 1 number
                                                " triggers=""  #pop="bs-popover" [isOpen]="password.errors?.pattern"
                                                popoverTitle="Password requirements:"
                                                >
                                                <p class="bg-warning p-xs b-r-sm" *ngIf="password.errors?.pattern && password.touched == true">Password must meet the requirements</p>
                                            </div>
                                            <div class="form-group">
                                                <label>Confirm Password * </label>
                                                <input  required type="password"  name="confirmPassword" class="form-control required" formControlName="confirmPassword">
                                                <p class="bg-danger p-xs b-r-sm" *ngIf="passwordFormGroup.errors?.doesMatchValue && password.touched == true">Password does not match</p>
                                            </div>
                                        </form>
                                        </div>
                                        <div class="col-lg-4">
                                            <div class="text-center">
                                                <div style="margin-top: 20px">
                                                    <i class="fa fa-sign-in" style="font-size: 180px;color: #e5e5e5 "></i>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                                </tab>

                                <tab #2 heading="2.Profile" >
                                    <h2>Profile Information</h2>
                                    <form [formGroup]="profileFormGroup">
                                    <!-- <div class="row">
                                        {{profileFormGroup.value | json}}
                                    </div> -->
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>First name *</label>
                                                    <input  name="name" type="text" class="form-control required" formControlName="firstName" >
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Last name *</label>
                                                    <input   name="surname" type="text" class="form-control required" formControlName="lastName" >
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <div class="form-group" fxShow.xs="false" fxShow="true">
                                                    <label>Date of Birth *</label>
                                                    <input (click)="setInitialBirthDate()"
                                                    #dp="bsDatepicker"
                                                    bsDatepicker
                                                    placeholder="MM/DD/YYYY"
                                                    [(ngModel)]="datePickerInitialDate"
                                                    class="form-control required"
                                                    type="text"
                                                    [bsConfig]="bsConfig"
                                                    formControlName="dateOfBirth" />
                                                </div>
                                                <div class="form-group" fxShow.gt-xs="false" fxShow="true" >
                                                    <label>Date of Birth *</label>
                                                <input
                                                    class="form-control required"
                                                    type="date"
                                                    formControlName="dateOfBirth"/>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Driver's License Number *</label>
                                                    <input  name="address" type="tel" class="form-control required" formControlName="driverLicense" >
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Home phone</label>
                                                    <input name="email" type="tel" id="home_phone" data-mask="(999) 999-9999" class="form-control">
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>Mobile phone *</label>
                                                    <input name="email" type="tel" id="mobile_phone" (blur)="setMobileNumber($event.target.value)" data-mask="(999) 999-9999" class="form-control">
                                                </div>
                                            </div>
                                        </div>

                                        <!-- <div class="row">
                                            <div class="col-lg-6">
                                                <div class="form-group">
                                                    <label>SSN (not required)</label>
                                                    <input name="email" type="number" class="form-control" formControlName="SSN">
                                                </div>
                                            </div>
                                        </div> -->

                                        <hr>

                                        <div class="row">
                                            <div class="col-lg-6" style="margin-top: 40px">
                                                <div class="col-lg-12" style="padding-bottom: 5px">
                                                    <label>Service Address *</label>
                                                    <input name="serviceAddress" type="text" class="form-control required" formControlName="serviceAddress" (change)="updateMailingAddress()">
                                                </div>
                                                <div class="col-lg-4" style="padding-bottom: 5px">
                                                    <div class="form-group">
                                                        <label>City</label>
                                                        <input name="city" type="text" class="form-control required" formControlName="serviceCity" >
                                                    </div>
                                                </div>
                                                <div class="col-lg-4" style="padding-bottom: 5px">
                                                    <div class="form-group">
                                                        <label>State</label>
                                                        <input name="state" type="text" class="form-control required" formControlName="serviceState" >
                                                    </div>
                                                </div>
                                                <div class="col-lg-4" style="padding-bottom: 5px">
                                                    <div class="form-group">
                                                        <label>Zipcode *</label>
                                                        <input name="zipcode" type="text" class="form-control required" formControlName="serviceZipcode" (change)="updateMailingAddress()">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-6" style="text-align: center">
                                                <div class="checkbox">
                                                    <div class="checkbox ">
                                                        <label>
                                                            <input type="checkbox" formControlName="useServiceAddrForMailing" (change)="toggleMailingAddress()">My mailing address is the same as my service address
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="col-lg-12" style="padding-bottom: 5px">
                                                    <label>Mailing Address *</label>
                                                    <input name="mailingAddress" type="text" class="form-control required" formControlName="mailingAddress">
                                                </div>
                                                <div class="col-lg-4" style="padding-bottom: 5px">
                                                    <div class="form-group">
                                                        <label>City</label>
                                                        <input name="city" type="text" class="form-control required" formControlName="mailingCity">
                                                    </div>
                                                </div>
                                                <div class="col-lg-4" style="padding-bottom: 5px">
                                                    <div class="form-group">
                                                        <label>State</label>
                                                        <input name="state" type="text" class="form-control required" formControlName="mailingState">
                                                    </div>
                                                </div>
                                                <div class="col-lg-4" style="padding-bottom: 5px">
                                                    <div class="form-group">
                                                        <label>Zipcode</label>
                                                        <input name="zipcode" type="text" class="form-control required" formControlName="mailingZipcode">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <hr>

                                        <div class="row">
                                            <div class="col-lg-6">
                                                    <div class="form-group">
                                                    <label>Copy of ID *</label>

                                                    <div [hidden]="!idUploadLoading" class="text-center" style="margin-top:20px;margin-bottom:20px">
                                                            <div class="sk-spinner sk-spinner-three-bounce">
                                                                <div class="sk-bounce1"></div>
                                                                <div class="sk-bounce2"></div>
                                                                <div class="sk-bounce3"></div>
                                                            </div>
                                                        </div>

                                                    <div [hidden]="idUploadLoading" class="input-group">
                                                            <span class="input-group-btn">
                                                                <div  *ngIf="idPreviewFile" class="col-md-4 col-sm-6">
                                                                        <div class="thumbnail">
                                                                            <div class="thumb">
                                                                            <img class="ticket-image" src="{{idPreviewFile?.data}}">
                                                                            </div>

                                                                            <div class="caption text-center wordwrap">
                                                                            {{idPreviewFile?.name}}
                                                                            </div>
                                                                        </div>
                                                                    </div>

                                                            <label [hidden]="idUploadLoading"  title="Upload image file" for="inputIDImage" class="btn btn-success">
                                                            <input [hidden]="true" type="text" formControlName="copyOfID">
                                                            <input type="file" accept="image/*" name="file" id="inputIDImage" class="hide" (change)="copyOfIDOnFileChange($event)"  >
                                                            <span [hidden]="idPreviewFile" > Upload Image </span>
                                                            <span [hidden]="!idPreviewFile" > Change Image </span>
                                                        </label>
                                                        </span>
                                                        </div>
                                                    </div>

                                                    <div class="form-group">
                                                    <label>Deed/Rental Agreement/Legal Documents *</label>

                                                    <div [hidden]="!raUploadLoading" class="text-center" style="margin-top:20px;margin-bottom:20px">
                                                        <div class="sk-spinner sk-spinner-three-bounce">
                                                            <div class="sk-bounce1"></div>
                                                            <div class="sk-bounce2"></div>
                                                            <div class="sk-bounce3"></div>
                                                        </div>
                                                    </div>

                                                    <div [hidden]="raUploadLoading" class="input-group">
                                                            <span class="input-group-btn">
                                                            <div *ngIf="RAPreviewFile" class="col-md-4 col-sm-6">
                                                                    <div class="thumbnail">
                                                                        <div class="thumb">
                                                                        <img class="ticket-image" src="{{RAPreviewFile?.data}}">
                                                                        </div>

                                                                        <div class="caption text-center wordwrap">
                                                                        {{RAPreviewFile?.name}}
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                        <label [hidden]="raUploadLoading" title="Upload image file" for="inputRAImage" class="btn btn-success">
                                                            <input [hidden]="true" type="text" formControlName="rentalAgreement" >
                                                        <input type="file" accept="image/*" name="file" id="inputRAImage" class="hide" (change)="RAOnFileChange($event)" >
                                                        <span [hidden]="RAPreviewFile" > Upload Image </span>
                                                        <span [hidden]="!RAPreviewFile" > Change Image </span>
                                                    </label>
                                                    </span>
                                                    </div>
                                                    </div>
                                            </div>
                                            <div class="col-lg-6">
                                                    <!-- <div class="form-group">
                                                            <label>Zip Code *</label>
                                                            <input name="address" type="tel" class="form-control required" formControlName="zipcode"
                                                            popover=" #####
                                                            " triggers=""  #pop="bs-popover" [isOpen]="zipcode.errors?.maxLength"
                                                            popoverTitle="Valid zipcode example:"
                                                            >
                                                            <p class="bg-danger p-xs b-r-sm" *ngIf="zipcode.touched == true && zipcode.dirty == true && zipcode.errors?.maxLength">Please enter a valid zipcode</p>
                                                    </div> -->
                                                <form [formGroup]="accountTypeControl">
                                                    <div class="form-group">

                                                            <label>Type of Account *</label>
                                                            <select class="form-control m-b required" formControlName="accountTypeControl"  name="account" formControlName="typeOfAccount" >
                                                                    <!-- <option *ngFor="let type of types" [ngValue]="type">[NO DATA KNOWN]</option> -->
                                                                    <option value="" disabled>Select Type</option>
                                                                    <option *ngFor="let type of aTypes" value="{{type?.id}}">{{type?.name}}</option>
                                                            </select>
                                                    </div>
                                                </form>

                                                <div class="row">
                                                    <div class="form-group col-md-2">
                                                        <div class="checkbox" >
                                                            <div class="checkbox "><label> <input type="checkbox" [ngModel]="!profileFormGroup.get('renting').value" (change)="profileFormGroup.patchValue({renting: !$event.currentTarget.checked})"  [ngModelOptions]="{standalone: true}" /><i></i> Own </label></div>
                                                            <div class="checkbox "><label> <input type="checkbox" formControlName="renting" ><i></i> Renting </label></div>
                                                        </div>
                                                    </div>

                                                    <div class="form-group col-md-6">
                                                        <div class="checkbox" >
                                                            <div class="checkbox "><label> <input type="checkbox" formControlName="requireTrashBin"  ><i></i> Require Trash Bin </label>
                                                                <span class="text-muted">(Additional fees may apply)</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </form>
                                </tab>
                                <tab heading="3.Finish">
                                    <form [formGroup]="finishFormGroup">
                                        <h2>Terms and Conditions</h2> <p>
                                        <p class="required">Please, read the "terms of service", click <a (click)="triggerTermsModal()" >HERE.</a></p>
                                        <input name="acceptTerms" type="checkbox" class="required" formControlName="acceptTerms"> <label for="acceptTerms" style="padding-left: 5px;"> I agree with the <a (click)="triggerTermsModal()">Terms and conditions.</a></label>
                                    </form>
                                </tab>

                            </tabset>
                            <div style="text-align: right">
                               <!-- <button (click)="logValidator()" class="btn btn-success" >log validator</button> -->
                                <button  *ngIf="currentTab == 1 || currentTab == 2" (click)="previous(currentTab)"  type="button"  class="btn btn-success" style="margin-right: 1rem" > Previous </button>
                                <button  (click)="next(currentTab)"  [disabled]="!accountFormGroup.valid" type="button"   class="btn btn-success" *ngIf="currentTab == 0" > Next </button>
                                <button  (click)="next(currentTab)"  [disabled]="!profileFormGroup.valid" type="button"   class="btn btn-success" *ngIf="currentTab == 1" > Next </button>
                                <button  id="finish-signup" [disabled]="!accountFormGroup.valid" [disabled]="!finishFormGroup.value.acceptTerms" type="submit" class="btn btn-success" *ngIf="currentTab == 2"  > Finish </button>

                            </div>
                        </form>
                    </div>
                </div>
            </div>

        </div>
    </div>
</body>

    <swal #signupSuccess title="Your signup request has been sent" text="" type="success" [showCancelButton]="false" (confirm)="returnToLogin()" [allowOutsideClick]=false>
    </swal>

    <swal #signupFailure title="Something went wrong with the request, we are very sorry" text="{{finishMessage}}" type="error" [showCancelButton]="false">
    </swal>
    <swal #serverError title="There was an error contacting the server, we are very sorry" text="" type="error" [showCancelButton]="false" (confirm)="returnToLogin()">
    </swal>
